hAssembler

برنامه اسمبلر را به زبان پایتون بنویسید.

لیست دستورات : برای تمام حالت ۸ و ۱۶و ۳۲و ۶۴ بیتی و تمام مدهای آدرس دهی (برای 64 بیتی)

mov	add	adc	sub	sbb
and	or	xor	dec	inc
cmp	test	xchg	xadd	
imul	idiv			
bsf	bsr			
stc	clc	std	cld	
jmp	jcc			
shl	shr	neg	not	
call	ret	syscall	push	pop
دقت کنید که مد ۶۴ بیتی مد نظر است.

قوانین ورودی برنامه hassembler و خروجی برنامه hdisassembler
1- بین دستور‌العمل و اپرند‌اول آن دستور‌العمل ( در صورت وجود) یک فاصله Space وجود دارد.

2- اگر دستور‌العمل دارای دو اپرند بود ، بین دو اپرند هیچی چیز به غیر از comma وجود نخواهد داشت یعنی comma به ابتدای اپرند دوم و انتهای اپرند اول چسبیده است. مثال (mov rax,rbx )

3- اگر یکی از اپرند‌ها حافظه بود حتما سایز آن باید مشخص باشد و کلمه PTR جلوی آن نوشته شده باشد در ضمن بین نمایش سایز حافظه و کلمه PTR یک فاصله و بین PTR و کروشه باز ( [ ) یک فاصله وجود دارد. مثال اگر حافظه 16 بیتی باشد ( or WORD PTR [edx*8],ax ) که در این مثال حافظه اپرند اول بود.

4- اگر اپرندی حافظه باشد بین عناصر آن هیچ فاصله ای وجود نخواهد داشت.

mov edx,DWORD ptr [ebx+ecx*1+0x32345467]

5- اگر در نشان دادن حافظه displacement ای وجود داشته باشد ، باید حتما به صورت hex بود و ابتدای آن 0x وجود داشته باشد ( در بقیه موارد امکان دارد اعداد بصورت decimal نیز بیایند) مانند مثال بالا.

6- همه حروف به صورت حروف کوچک انگلیسی هستند. به غیر از BYTE , WORD, DWORD, QWORD

7- موقعی که یکی اپرند ها حافظه هست و رجیستر index وجود دارد ، حتما اسکیل را چاپ کنید ( حتی اگر 1 باشد )

8- ترتیب قرارگیری base, index, scale , disp در حافظه این گونه است ( ممکن است برخی از عناصر وجود نداشته باشد. غیر از index و scale که حتما با هم وجود دارند ( مورد 7) ) [base+index*scale+disp]

9- حواس‌تان به مواردی که ebp یا rbp به عنوان رجیستر base انتخاب می‌شود ، باشد حتما حالات مختلف آن را با سایت چک کنید.

10- همه موارد طبق سایت defuse خواهد بود غیر از فاصله بین اپرند اول و اپراتور که به آن اشاره شد.

قوانین ورودی برنامه hdisassembler و خروجی hassembler
1- حتما باید عددی که میدهید hex باشد.

2- در ابتدای آن 0x نباید وجود داشته باشد

تذکر
برای دستور imul حواس‌تان به استثنا موجود در آن باشد. برای دستور idiv فقط برای حالت یک اپرندی کد بزنید ( که یک اپرند آن al یا ax یا eax است.) برای shr و shl حالتی که در آن تعداد شیفت در متغیر‌ cl نگهداری می‌شود را نیازی نیست کد شما برای آن کار کند.